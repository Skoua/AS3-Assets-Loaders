package ar.net{	import flash.display.Bitmap;	import flash.display.Loader;	import flash.net.URLRequest;	import flash.events.IOErrorEvent;	import flash.events.ProgressEvent;	import flash.events.Event;	import flash.events.EventDispatcher;	import ar.events.ImageLoaderEvent;		public class ImageLoader extends EventDispatcher	{		private var loader:Loader;		private var url:String;		private var currentPerc:Number;		private var bmp:Bitmap;		private var someIndex:int;		private var daPos:int;				public function ImageLoader():void		{			loader = new Loader();		}				public function load(pURL:String, pProgress:Boolean = false):void		{			url = pURL;						if(pProgress) loader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onProgress);			loader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, onError);			loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);			loader.load(new URLRequest(url));		}				private function onProgress(e:ProgressEvent):void		{			currentPerc = e.target.bytesLoaded / e.target.bytesTotal;			dispatchEvent(new ImageLoaderEvent(ImageLoaderEvent.PROGRESS));		}				private function onError(e:IOErrorEvent):void		{			throw new Error('Can\'t find file: ' + url);		}				private function onComplete(e:Event):void		{			if(e.target.hasEventListener(ImageLoaderEvent.PROGRESS)) e.target.removeEventListener(ProgressEvent.PROGRESS, onProgress);			e.target.removeEventListener(IOErrorEvent.IO_ERROR, onError);			e.target.removeEventListener(Event.COMPLETE, onComplete);						bmp = e.target.content;						dispatchEvent(new ImageLoaderEvent(ImageLoaderEvent.COMPLETE));		}				public function get perc():Number		{			return currentPerc;		}				public function get content():Bitmap		{			return bmp;		}				public function get index():int		{			return someIndex;		}				public function set index(pIndex):void		{			someIndex = pIndex;		}				public function get pos():int		{			return daPos;		}				public function set pos(pPos:int):void		{			daPos = pPos;		}	}}