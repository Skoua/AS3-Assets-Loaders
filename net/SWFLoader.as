package ar.net{	import flash.display.DisplayObject;	import flash.display.Loader;	import flash.net.URLRequest;	import flash.events.IOErrorEvent;	import flash.events.ProgressEvent;	import flash.events.Event;	import flash.events.EventDispatcher;	import ar.events.SWFLoaderEvent;		public class SWFLoader extends EventDispatcher	{		private var loader:Loader;		private var url:String;		private var as2:Boolean;		private var currentPerc:Number;		private var swf:DisplayObject;				public function SWFLoader():void		{			loader = new Loader();		}				public function load(pURL:String, pProgress:Boolean = false, pAS2:Boolean = false):void		{			url = pURL;			as2 = pAS2;						if(pProgress) loader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onProgress);			loader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, onError);			loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onComplete);			loader.load(new URLRequest(url));		}				private function onProgress(e:ProgressEvent):void		{			currentPerc = e.target.bytesLoaded / e.target.bytesTotal;			dispatchEvent(new SWFLoaderEvent(SWFLoaderEvent.PROGRESS));		}				private function onError(e:IOErrorEvent):void		{			throw new Error("Can't find SWF file: " + url);		}				private function onComplete(e:Event):void		{			if(e.target.hasEventListener(ProgressEvent.PROGRESS)) e.target.removeEventListener(ProgressEvent.PROGRESS, onProgress);			e.target.removeEventListener(IOErrorEvent.IO_ERROR, onError);			e.target.removeEventListener(Event.COMPLETE, onComplete);						if(!as2) swf = e.target.content;			else swf = loader;			loader = null;						dispatchEvent(new SWFLoaderEvent(SWFLoaderEvent.COMPLETE));		}				public function get perc():Number		{			return currentPerc;		}				public function get content():DisplayObject		{			return swf;		}	}}